@model Kartverket.Web.Models.MapViewModel
@{
    ViewData["Title"] = "Velg et punkt på kartet";
}

<h2 class="text-xl font-bold mb-4">Velg et punkt på kartet</h2>

<div id="map" style="height: 400px;" class="mb-4 border rounded shadow"></div>

<form asp-controller="Map" asp-action="ShowLocation" method="post" class="space-y-2">
    <input type="hidden" asp-for="Latitude" id="Latitude" />
    <input type="hidden" asp-for="Longitude" id="Longitude" />
    <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">Send posisjon</button>
</form>

@section Scripts {
<script>
    var map = L.map('map').setView([59.91, 10.75], 13); // Start i Oslo

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 19
    }).addTo(map);

    var marker;
    map.on('click', function (e) {
        if (marker) {
            map.removeLayer(marker);
        }
        marker = L.marker(e.latlng).addTo(map);

        // Send koordinater til skjema
        document.getElementById('Latitude').value = e.latlng.lat;
        document.getElementById('Longitude').value = e.latlng.lng;
    });
</script>
}
